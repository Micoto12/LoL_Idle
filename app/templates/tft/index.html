{% extends "base.html" %}

{% block title %}TFT –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è - LolIdle{% endblock %}

{% block content %}
<div class="tft-container">
    <h1>üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –≤ Teamfight Tactics</h1>
    <p>–í–≤–µ–¥–∏—Ç–µ —Å–≤–æ–π Riot ID, —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å, –∫–∞–∫–∏–µ –∞—á–∏–≤–∫–∏ –≤—ã —É–∂–µ –ø–æ–ª—É—á–∏–ª–∏!</p>

    <form method="POST" action="{{ url_for('tft.search_player') }}" class="tft-search-form">
        <input type="text" name="game_name" placeholder="–ò–º—è –∏–≥—Ä–æ–∫–∞" required>
        <input type="text" name="tag_line" placeholder="–¢–µ–≥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, RU1)" required>
        
        <!-- –í—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ä–µ–≥–∏–æ–Ω–∞ -->
        <select name="region" required>
            <option value="" disabled selected>–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–≥–∏–æ–Ω</option>
            <option value="americas">Americas</option>
            <option value="asia">Asia</option>
            <option value="europe" selected>Europe</option>
        </select>
        
        <button type="submit">–ù–∞–π—Ç–∏</button>
    </form>

    {% if player_name %}
        <h2>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è: {{ player_name }}</h2>

        {% if unlocked_achievements %}
            <div class="achievements-list">
                <h3>üéâ –ü–æ–ª—É—á–µ–Ω–Ω—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è:</h3>
                <ul>
                    {% for ach in unlocked_achievements %}
                    <li>
                        <strong>{{ ach.icon }} {{ ach.name }}</strong>
                        <p>{{ ach.description }}</p>
                    </li>
                    {% endfor %}
                </ul>
            </div>
        {% else %}
            <p>–ü–æ–∫–∞ —á—Ç–æ –≤—ã –Ω–µ –ø–æ–ª—É—á–∏–ª–∏ –Ω–∏ –æ–¥–Ω–æ–≥–æ –∏–∑ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã—Ö –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π. –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –∏–≥—Ä–∞—Ç—å!</p>
        {% endif %}

        <div class="matches-list">
            <h3>üìä –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–∞—Ç—á–∏:</h3>
            {% for match in analyzed_matches %}
            <div class="match-card">
                <h4>--- üéØ –ú–∞—Ç—á {{ loop.index }}: {{ match.id}} ---</h4>
                <p>üèÜ –ú–µ—Å—Ç–æ: {{ match.placement }}</p>
                <p>üìà –£—Ä–æ–≤–µ–Ω—å: {{ match.level }} | üí∞ –ó–æ–ª–æ—Ç–∞: {{ match.gold_left }} | üîÑ –†–∞—É–Ω–¥: {{ match.last_round }}</p>

                <p><strong>üß¨ –°–∏–Ω–µ—Ä–≥–∏–∏:</strong></p>
                <ul class="traits-list">
                    {% for trait in match.traits %}
                    <li>- {{ trait.name }} (—É—Ä–æ–≤–µ–Ω—å {{ trait.tier }})</li>
                    {% else %}
                    <li>–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–∏–Ω–µ—Ä–≥–∏–π</li>
                    {% endfor %}
                </ul>

                <p><strong>üëæ –Æ–Ω–∏—Ç—ã:</strong></p>
                <ul class="units-list">
                    {% for unit in match.units %}
                    <li>
                        - {{ unit.character }} (‚òÖ {{ unit.tier }}) ‚Äî –ø—Ä–µ–¥–º–µ—Ç—ã: 
                        {% set item_list = unit.get('items', []) %}
                        {% if item_list | length > 0 %}
                            [{{ item_list | join(', ') }}]
                        {% else %}
                            [–±–µ–∑ –ø—Ä–µ–¥–º–µ—Ç–æ–≤]
                        {% endif %}
                    </li>
                    {% else %}
                    <li>–ù–µ—Ç —é–Ω–∏—Ç–æ–≤</li>
                    {% endfor %}
                </ul>

                {% if match.unlocked_in_match %}
                    <div class="match-achievements">
                        <strong>–ù–æ–≤—ã–µ –∞—á–∏–≤–∫–∏ –≤ —ç—Ç–æ–º –º–∞—Ç—á–µ:</strong>
                        <ul>
                            {% for ach in match.unlocked_in_match %}
                            <li>{{ ach.icon }} {{ ach.name }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                {% endif %}
            </div>
            {% endfor %}
        </div>
    {% endif %}
</div>
{% endblock %}

{% block scripts %}
<style>
.tft-container { max-width: 800px; margin: 0 auto; padding: 20px; }
.tft-search-form { display: flex; gap: 10px; margin: 20px 0; }
.tft-search-form input { padding: 10px; flex: 1; }
.tft-search-form button { padding: 10px 20px; }
.achievements-list, .matches-list { margin-top: 30px; }
.match-achievements { background: #e8f5e8; padding: 10px; margin-top: 10px; border-radius: 4px; }
.match-card {
    background: #f9f9f9;
    border: 1px solid #e0e0e0;
    border-radius: 8px;
    padding: 16px;
    margin: 16px 0;
    font-family: 'Courier New', monospace;
}
.match-card h4 {
    margin-top: 0;
    color: #2c3e50;
}
.traits-list, .units-list {
    list-style-type: none;
    padding-left: 20px;
}
.traits-list li, .units-list li {
    margin: 4px 0;
    font-size: 14px;
}
</style>
{% endblock %}